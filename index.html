<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>SAMAA PADEL CLUB | Reserva tu Cancha</title>
    <!-- Carga de la fuente original: Montserrat (moderna, robusta, sans-serif) -->
    <link href="https://fonts.googleapis.com/css2?family=Montserrat:wght@400;600;700;800;900&display=swap" rel="stylesheet">
    
    <!-- Carga de Tailwind CSS -->
    <script src="https://cdn.tailwindcss.com"></script>
    <!-- Configuraci√≥n personalizada de Tailwind -->
    <script>
        tailwind.config = {
            theme: {
                extend: {
                    colors: {
                        // Colores ajustados para simular el estilo premium oscuro de las capturas
                        'primary-dark': '#111827', // Fondo y Reservado (gris muy oscuro)
                        'secondary-dark': '#1F2937', // Fondo de tarjetas y Disponible (gris medio)
                        'accent': '#14B8A6', // Teal brillante (HOY, Selecci√≥n, Botones)
                        'accent-hover': '#0D9488',
                        // Colores espec√≠ficos para el aviso de se√±a
                        'se√±a-bg': '#FFFBEA', // Fondo crema muy claro (simulando yellow-50)
                        'se√±a-border': '#FDE68A', // Borde amarillo (simulando yellow-300)
                        'se√±a-text': '#78350F', // Texto oscuro (simulando amber-900)
                        'se√±a-title': '#10B981', // T√≠tulo verde (simulando emerald-500, o un color que destaque)
                    },
                    fontFamily: {
                        // Usamos Montserrat (robusta y moderna)
                        sans: ['Montserrat', 'sans-serif'],
                    },
                }
            }
        }
    </script>
    <style>
        /* Estilos generales para el fondo y la fuente */
        body {
            background-color: #030712; /* Fondo muy oscuro */
            color: #E5E7EB; /* Texto claro */
            /* Tailwind ahora aplica Montserrat como fuente principal */
            min-height: 100vh;
            /* Scroll behavior smooth para el efecto de anclaje de JS */
            scroll-behavior: smooth;
        }
        /* Estilo para un efecto de caja m√°s notorio */
        .card-glow {
            box-shadow: 0 10px 15px -3px rgba(0, 0, 0, 0.1), 0 4px 6px -2px rgba(0, 0, 0, 0.05);
            transition: transform 0.3s ease;
        }
        .card-glow:hover {
            transform: translateY(-4px);
        }
        /* Estilos para el slot de tiempo seleccionado */
        .time-slot.selected {
            background-color: #14B8A6 !important; /* color-accent */
            border-color: #14B8A6 !important; /* color-accent */
            color: #111827 !important; /* color-primary-dark */
            font-weight: bold;
        }
        /* Oculta los checkboxes reales */
        .time-slot input[type="checkbox"] {
            display: none;
        }
        .slot-content {
             padding: 0.5rem;
             display: block;
             text-align: center;
             height: 100%;
             user-select: none;
        }
        /* Estilo para el Hero Section con imagen de fondo */
        #hero-section {
            /* RUTA CORREGIDA: Usamos ruta relativa */
            background-image: url('./hero_background.jpg');
            background-size: cover;
            background-position: center 30%; 
            position: relative;
            padding-top: 10rem;
            padding-bottom: 10rem;
        }
        #hero-section::before {
            content: "";
            position: absolute;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            background-color: rgba(3, 7, 18, 0.85); 
            z-index: 1;
        }
        #hero-content {
            position: relative;
            z-index: 2;
        }
        /* Estilo para el contenedor de d√≠as (scroll horizontal) */
        #days-slider {
            overflow-x: scroll;
            white-space: nowrap;
            -webkit-overflow-scrolling: touch;
            scrollbar-width: none; /* Firefox */
        }
        #days-slider::-webkit-scrollbar {
            display: none; /* Chrome, Safari, Opera */
        }
        /* Estilo para los checkmarks en el banner de beneficios */
        .benefit-item {
            display: inline-flex;
            align-items: center;
            color: #E5E7EB; /* Texto claro */
            font-size: 0.875rem; /* text-sm */
            margin: 0.5rem 1rem;
        }
        .benefit-item .icon {
            color: #14B8A6; /* accent color */
            margin-right: 0.5rem;
            width: 1rem;
            height: 1rem;
        }
        /* Loader styles */
        .loader {
            border: 4px solid #f3f3f3; /* Light grey */
            border-top: 4px solid #14B8A6; /* Accent color */
            border-radius: 50%;
            width: 24px;
            height: 24px;
            animation: spin 1s linear infinite;
            margin: 0 auto;
        }
        @keyframes spin {
            0% { transform: rotate(0deg); }
            100% { transform: rotate(360deg); }
        }
    </style>
</head>
<body class="antialiased flex flex-col">

    <!-- Encabezado y Navegaci√≥n -->
    <header class="bg-primary-dark shadow-lg sticky top-0 z-10">
        <div class="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-3 flex justify-between items-center">
            <!-- Logo del Club -->
            <div class="flex items-center space-x-3">
                <!-- RUTA CORREGIDA: Usamos ruta relativa -->
                <img id="logo-img" src="./logo_padel.png"
                     alt="Logo SAMAA PADEL CLUB"
                     class="h-10 w-auto rounded-lg"
                     onerror="this.onerror=null; this.src='https://placehold.co/80x40/14B8A6/FFFFFF?text=SAMAA';">
                <h1 class="text-xl font-extrabold tracking-tight text-white hidden sm:block">SAMAA PADEL CLUB</h1>
            </div>

            <!-- Navegaci√≥n Principal -->
            <nav class="space-x-4">
                <!-- El orden de los enlaces de navegaci√≥n es importante, pero el scroll lo maneja JS -->
                <a href="#instalaciones" class="nav-link text-white hover:text-accent transition duration-150 ease-in-out font-medium">Instalaciones</a>
                <a href="#reservas" class="nav-link text-white hover:text-accent transition duration-150 ease-in-out font-medium">Reservar</a>
                <a href="#contacto" class="nav-link text-white hover:text-accent transition duration-150 ease-in-out font-medium">Ubicaci√≥n</a>
            </nav>
        </div>
    </header>

    <!-- Contenido Principal -->
    <main class="flex-grow">

        <!-- 1. SECCI√ìN PRINCIPAL (HOME) -->
        <section id="hero-section" class="border-b-4 border-accent">
            <div id="hero-content" class="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 text-center">
                <!-- Texto superior: ABIERTO DE LUNES A S√ÅBADOS ‚Ä¢ 10:00 A 00:00 HS -->
                <div class="bg-accent text-primary-dark text-xs font-bold px-3 py-1 rounded-full inline-block mb-4">ABIERTO DE LUNES A S√ÅBADOS ‚Ä¢ 10:00 A 00:00 HS</div>

                <!-- T√≠tulo: Viv√≠ la experiencia Samaa Padel Club (DIVIDIDO EN DOS L√çNEAS) -->
                <h2 class="mt-2 text-5xl sm:text-7xl font-black text-white leading-none">
                    Viv√≠ la experiencia <br class="block"> 
                    <span class="text-accent">Samaa Padel Club</span>
                </h2>
                <!-- Texto de descripci√≥n: Tu lugar en Ituzaing√≥... -->
                <p class="mt-4 text-lg text-gray-200 max-w-3xl mx-auto">
                    Tu lugar en Ituzaing√≥. Canchas premium, ambiente relajado y el mejor nivel de juego del oeste.
                </p>
                
                <!-- Botones de Acci√≥n -->
                <div class="mt-8 flex justify-center space-x-4">
                    <!-- ID a√±adido para el selector de JS -->
                    <a href="#reservas" id="reservar-ahora-btn" class="inline-block bg-accent hover:bg-accent-hover text-primary-dark font-bold py-3 px-6 rounded-lg shadow-xl transition duration-300 transform hover:scale-105">
                        Reservar Ahora ‚Üì
                    </a>
                    <a href="#contacto" class="inline-flex items-center space-x-2 bg-secondary-dark hover:bg-gray-700 text-white font-bold py-3 px-6 rounded-lg shadow-xl transition duration-300 transform hover:scale-105">
                         <span>Ver Mapa</span>
                         <span role="img" aria-label="pin">üìç</span>
                    </a>
                </div>
            </div>
        </section>

        <!-- SECCI√ìN DE BENEFICIOS (TAL CUAL LA FOTO) -->
        <div class="bg-primary-dark border-b border-gray-800 py-4 hidden md:block">
            <div class="max-w-7xl mx-auto px-4 text-center flex flex-wrap justify-around">
                <!-- Cesped Sint√©tico Pro -->
                <div class="benefit-item">
                    <svg class="icon" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 20 20" fill="currentColor"><path fill-rule="evenodd" d="M16.704 4.153a.75.75 0 01.143 1.052l-8 10.5a.75.75 0 01-1.127.075l-4.5-4.5a.75.75 0 011.06-1.06l3.894 3.893 7.48-9.817a.75.75 0 011.05-.143z" clip-rule="evenodd" /></svg>
                    C√©sped Sint√©tico Pro
                </div>
                <!-- Iluminaci√≥n LED -->
                <div class="benefit-item">
                    <svg class="icon" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 20 20" fill="currentColor"><path fill-rule="evenodd" d="M16.704 4.153a.75.75 0 01.143 1.052l-8 10.5a.75.75 0 01-1.127.075l-4.5-4.5a.75.75 0 011.06-1.06l3.894 3.893 7.48-9.817a.75.75 0 011.05-.143z" clip-rule="evenodd" /></svg>
                    Iluminaci√≥n LED
                </div>
                <!-- Av. Rivadavia 22800 -->
                <div class="benefit-item">
                    <svg class="icon" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 20 20" fill="currentColor"><path fill-rule="evenodd" d="M16.704 4.153a.75.75 0 01.143 1.052l-8 10.5a.75.75 0 01-1.127.075l-4.5-4.5a.75.75 0 011.06-1.06l3.894 3.893 7.48-9.817a.75.75 0 011.05-.143z" clip-rule="evenodd" /></svg>
                    Av. Rivadavia 22800
                </div>
                <!-- Buffet & Bar -->
                <div class="benefit-item">
                    <svg class="icon" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 20 20" fill="currentColor"><path fill-rule="evenodd" d="M16.704 4.153a.75.75 0 01.143 1.052l-8 10.5a.75.75 0 001.05-.143z" clip-rule="evenodd" /></svg>
                    Buffet & Bar
                </div>
            </div>
        </div>
        <!-- FIN SECCI√ìN DE BENEFICIOS -->

        <!-- 2. START OF NEW INSTALACIONES SECTION (AQU√ç EST√Å LA NUEVA POSICI√ìN) -->
        <section id="instalaciones" class="py-16 bg-gray-900 border-t border-gray-800">
            <div class="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8">
                <h3 class="text-3xl font-bold text-white mb-10 text-center">Nuestras Instalaciones</h3>
                
                <div class="grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-3 gap-6">
                    <!-- Item 1 - Pista 1 -->
                    <div class="rounded-xl overflow-hidden shadow-lg card-glow">
                        <!-- RUTA CORREGIDA: Usamos ruta relativa -->
                        <img src="./cancha_principal.jpeg" 
                             alt="FOTO CANCHA 1" class="w-full h-48 object-cover transition duration-300 hover:scale-105"
                             onerror="this.onerror=null; this.src='https://placehold.co/600x400/1F2937/FFFFFF?text=FOTO+CANCHA+1';">
                        <div class="p-4 bg-secondary-dark">
                            <p class="text-lg font-semibold text-white">Cancha Principal</p>
                            <p class="text-sm text-gray-400">Pasto sint√©tico premium y luces LED.</p>
                        </div>
                    </div>
                    <!-- Item 2 - Pista 2 -->
                    <div class="rounded-xl overflow-hidden shadow-lg card-glow">
                        <!-- RUTA CORREGIDA: Usamos ruta relativa -->
                        <img src="./vista_general.jpg" 
                             alt="FOTO VISTA GENERAL" class="w-full h-48 object-cover transition duration-300 hover:scale-105"
                             onerror="this.onerror=null; this.src='https://placehold.co/600x400/1F2937/FFFFFF?text=FOTO+VISTA+GENERAL';">
                        <div class="p-4 bg-secondary-dark">
                            <p class="text-lg font-semibold text-white">Vista General</p>
                            <p class="text-sm text-gray-400">Instalaciones modernas y amplias.</p>
                        </div>
                    </div>
                    <!-- Item 3 - Vestuarios/Bar -->
                    <div class="rounded-xl overflow-hidden shadow-lg card-glow">
                        <!-- RUTA CORREGIDA: Usamos ruta relativa -->
                        <img src="./bar_buffet.jpeg" 
                             alt="FOTO BAR Y BUFFET" class="w-full h-48 object-cover transition duration-300 hover:scale-105"
                             onerror="this.onerror=null; this.src='https://placehold.co/600x400/1F2937/FFFFFF?text=FOTO+BAR+Y+BUFFET';">
                        <div class="p-4 bg-secondary-dark">
                            <p class="text-lg font-semibold text-white">Buffet & Vestuarios</p>
                            <p class="text-sm text-gray-400">Espacios de descanso y comodidad.</p>
                        </div>
                    </div>
                </div>
            </div>
        </section>
        <!-- END OF NEW INSTALACIONES SECTION -->


        <!-- 3. Secci√≥n de Reservas (Core Functionality) -->
        <section id="reservas" class="py-16 bg-gray-900">
            <div class="max-w-4xl mx-auto px-4 sm:px-6 lg:px-8">
                <h3 class="text-3xl font-bold text-white mb-8 text-center">Selecciona tu Turno</h3>
                
                <div class="bg-secondary-dark p-4 sm:p-6 rounded-xl card-glow border border-gray-700">
                    
                    <!-- AVISO DE SE√ëA (REEMPLAZA AL CUADRO ROJO) -->
                    <div class="mb-6 p-4 border rounded-xl flex items-start space-x-3 bg-se√±a-bg border-se√±a-border">
                        <!-- Icono de Billetera/Dinero (simulado con SVG) -->
                        <span class="text-2xl pt-0.5 text-se√±a-title">üí∞</span>
                        <div>
                            <p class="text-se√±a-title text-lg font-bold mb-1">Se√±a Requerida</p>
                            <p class="text-se√±a-text text-sm">
                                Para asegurar tu cancha en Samaa Padel solicitamos una se√±a de <span class="font-bold">$10.000 ARS</span>. El resto lo abonas en el club antes de ingresar.
                            </p>
                        </div>
                    </div>
                    <!-- FIN AVISO DE SE√ëA -->

                    <!-- 1. SELECCIONADOR DE D√çAS (Slider) -->
                    <div id="days-slider" class="flex space-x-2 pb-2 mb-4 mx-auto max-w-full">
                        <!-- D√≠as generados por JS -->
                    </div>
                    
                    <!-- Campo oculto de fecha que se actualizar√° con el slider -->
                    <input type="hidden" id="fecha" required>

                    <!-- 2. SELECTOR DE CANCHAS (Tabs/Buttons) -->
                    <div class="flex justify-center space-x-2 mb-8 p-1 bg-primary-dark rounded-full max-w-lg mx-auto">
                        
                        <!-- CANCHA 1: ACTUALIZADA A (Aire Libre) -->
                        <button type="button" data-cancha="cancha1" class="cancha-tab w-full py-2 px-4 rounded-full text-sm font-semibold transition bg-accent text-primary-dark shadow-md">
                            Cancha 1 (Aire Libre)
                        </button>
                        <!-- CANCHA 2: MANTENIDA COMO (Aire Libre) -->
                        <button type="button" data-cancha="cancha2" class="cancha-tab w-full py-2 px-4 rounded-full text-sm font-semibold transition text-gray-400 hover:bg-gray-700">
                            Cancha 2 (Aire Libre)
                        </button>
                        <!-- Selector real (se oculta y se usa para el env√≠o del formulario) -->
                        <select id="cancha" name="cancha" class="hidden">
                            <option value="cancha1" selected>Cancha 1 - Aire Libre</option>
                            <option value="cancha2">Cancha 2 - Aire Libre</option>
                            <option value="cancha3">Cancha 3 - Exterior Econ√≥mica</option>
                        </select>
                    </div>

                    <!-- 3. HORARIOS DISPONIBLES Y FORMULARIO -->
                    <!-- NOTA: El t√≠tulo se ajusta al nuevo formato de 30 minutos, y se permite seleccionar varios bloques. -->
                    <h4 class="text-xl font-semibold text-white mb-4 text-center">Horarios Disponibles (Bloques de 30 min - Selecciona varios)</h4>

                    <form id="reservationForm" class="space-y-6">

                        <!-- Grid de Horarios -->
                        <div id="horariosGrid" class="grid grid-cols-3 sm:grid-cols-4 md:grid-cols-5 gap-3">
                            <div class="col-span-full text-center p-4">
                                <p id="horario-message" class="text-gray-500 mt-2">Cargando disponibilidad...</p>
                            </div>
                        </div>
                        
                        <!-- Leyenda de Horarios -->
                        <div class="flex justify-center flex-wrap gap-4 text-sm pt-4 border-t border-gray-700">
                            <div class="flex items-center space-x-1">
                                <span class="w-3 h-3 rounded-full bg-secondary-dark border border-gray-500"></span>
                                <span class="text-gray-400">Libre (30 min)</span>
                            </div>
                            <div class="flex items-center space-x-1">
                                <span class="w-3 h-3 rounded-full bg-primary-dark border border-gray-800"></span>
                                <span class="text-gray-400">Ocupado</span>
                            </div>
                            <div class="flex items-center space-x-1">
                                <span class="w-3 h-3 rounded-full bg-accent"></span>
                                <span class="text-gray-400">Tu Selecci√≥n</span>
                            </div>
                        </div>

                        <!-- Campo de Nombre -->
                        <div>
                            <label for="nombre" class="block text-sm font-medium text-gray-300 mb-2">Tu Nombre</label>
                            <input type="text" id="nombre" required placeholder="Ej: Juan P√©rez"
                                class="w-full bg-primary-dark border border-gray-600 rounded-lg p-3 text-white focus:ring-accent focus:border-accent">
                        </div>

                        <!-- Campo de WhatsApp -->
                        <div>
                            <label for="whatsapp" class="block text-sm font-medium text-gray-300 mb-2">WhatsApp / Tel√©fono</label>
                            <input type="tel" id="whatsapp" required placeholder="Ej: 11 4079-8131"
                                class="w-full bg-primary-dark border border-gray-600 rounded-lg p-3 text-white focus:ring-accent focus:border-accent">
                        </div>
                        
                        <!-- Aceptaci√≥n de Pago (Ahora ajusta el precio por la cantidad de bloques seleccionados) -->
                        <div id="pagoSummary" class="bg-primary-dark p-4 rounded-lg border border-gray-700">
                            <p class="text-sm font-semibold text-white mb-2">
                                Bloques seleccionados: <span id="numBloques" class="text-accent font-bold">0</span>.
                            </p>
                            <p class="text-sm font-semibold text-white">
                                Costo total (Simulaci√≥n): <span id="costoTotal" class="text-accent font-bold">$0 ARS</span>. (Basado en $10.000 ARS por hora)
                            </p>
                        </div>
                        
                        <div>
                            <div class="flex items-center">
                                <input id="aceptarPago" type="checkbox" required
                                    class="h-5 w-5 text-accent rounded focus:ring-accent border-gray-600 bg-primary-dark">
                                <label for="aceptarPago" class="ml-3 block text-sm font-medium text-gray-300">
                                    Acepto pagar la se√±a de ARS 10.000 para confirmar mi reserva
                                </label>
                            </div>
                        </div>

                        <!-- Bot√≥n de Env√≠o -->
                        <button type="submit" id="submitButton"
                            class="w-full bg-accent hover:bg-accent-hover text-primary-dark font-extrabold py-3 rounded-lg shadow-2xl transition duration-200 transform hover:scale-[1.01]"
                            disabled>
                            PAGAR Y CONFIRMAR RESERVA
                        </button>
                    </form>

                    <!-- Mensaje de Resultado (Modal/Mensaje en l√≠nea) -->
                    <div id="messageBox" class="mt-6 p-4 rounded-lg text-center hidden transition duration-300 ease-in-out" role="alert">
                        <p id="messageText" class="font-semibold"></p>
                    </div>
                </div>
            </div>
        </section>

        <!-- 4. SECCI√ìN DONDE ESTAMOS (MAPA Y CONTACTO) -->
        <section id="contacto" class="bg-primary-dark border-t border-gray-800">
            <!-- Usamos h-screen/h-[70vh] para que la secci√≥n ocupe un buen espacio vertical, como en el ejemplo del mapa -->
            <div class="max-w-7xl mx-auto flex flex-col md:flex-row h-screen md:h-[70vh] min-h-[500px]">
                
                <!-- Panel de Informaci√≥n (Izquierda) - Colores y Estilos de la Captura -->
                <div class="bg-primary-dark p-8 md:p-12 w-full md:w-1/3 flex flex-col justify-start">
                    <h2 class="text-3xl font-extrabold text-white mb-8">D√≥nde Estamos</h2>

                    <div class="space-y-8 text-gray-300">
                        <!-- Direcci√≥n -->
                        <div>
                            <!-- Icono de ubicaci√≥n (simulado con SVG) -->
                            <div class="flex items-center space-x-3 mb-2">
                                <svg class="w-6 h-6 text-accent" fill="currentColor" viewBox="0 0 24 24"><path d="M12 2C8.13 2 5 5.13 5 9c0 5.25 7 13 7 13s7-7.75 7-13c0-3.87-3.13-7-7-7zm0 9.5c-1.38 0-2.5-1.12-2.5-2.5s1.12-2.5 2.5-2.5 2.5 1.12 2.5 2.5-1.12 2.5-2.5 2.5z"/></svg>
                                <h4 class="text-xl font-semibold text-white">Direcci√≥n</h4>
                            </div>
                            <p>Av. Rivadavia 22800</p>
                            <p>Ituzaing√≥, Buenos Aires</p>
                            <!-- El enlace 'C√≥mo llegar' se mantiene -->
                            <a href="https://www.google.com/maps/place/Av.+Rivadavia+22800,+B1714+Ituzaing%C3%B3,+Provincia+de+Buenos+Aires/@-34.6622291,-58.6856103,17z/data=!4m6!3m5!1s0x95bcbf7d64b5722d:0x26f952505a9332c0!8m2!3d-34.6632042!4d-58.6822736!16s%2Fg%2F11gr6hgl1r?entry=ttu" target="_blank" class="text-accent text-sm hover:underline mt-2 inline-block">C√≥mo llegar ‚Üí</a>
                        </div>

                        <!-- Reservas & Info (Tel√©fono/WhatsApp) -->
                        <div>
                            <!-- Icono de tel√©fono (simulado con SVG) -->
                            <div class="flex items-center space-x-3 mb-2">
                                <svg class="w-6 h-6 text-accent" fill="currentColor" viewBox="0 0 24 24"><path d="M20.01 15.38c-1.23 0-2.45-.2-3.62-.63-.44-.16-.92-.06-1.23.23l-2.22 2.22c-2.82-1.44-5.15-3.78-6.59-6.59l2.22-2.22c.3-.3.39-.78.23-1.23-.43-1.17-.63-2.38-.63-3.62 0-.83-.67-1.5-1.5-1.5H3.5c-.83 0-1.5.67-1.5 1.5 0 9.39 7.61 17 17 17 .83 0 1.5-.67 1.5-1.5v-2.78c0-.83-.67-1.5-1.5-1.5z"/></svg>
                                <h4 class="text-xl font-semibold text-white">Reservas & Info</h4>
                            </div>
                            <p>+54 11 4079-8131</p>
                            <p class="text-xs text-gray-500">Respondemos WhatsApp</p>
                        </div>

                        <!-- Confirmaciones (Email) -->
                        <div>
                            <!-- Icono de email (simulado con SVG) -->
                            <div class="flex items-center space-x-3 mb-2">
                                <svg class="w-6 h-6 text-accent" fill="currentColor" viewBox="0 0 24 24"><path d="M20 4H4c-1.1 0-1.99.9-1.99 2L2 18c0 1.1.9 2 2 2h16c1.1 0 2-.9 2-2V6c0-1.1-.9-2-2-2zm0 4l-8 5-8-5V6l8 5 8-5v2z"/></svg>
                                <h4 class="text-xl font-semibold text-white">Confirmaciones</h4>
                            </div>
                            <p>reservas@samaapadel.com.ar</p>
                            <p class="text-xs text-gray-500">Env√≠a tu comprobante aqu√≠</p>
                        </div>
                    </div>
                </div>

                <!-- Mapa (Derecha - ¬°MAPA INSERTADO!) -->
                <div class="w-full md:w-2/3 h-96 md:h-full overflow-hidden">
                    <!-- Modificamos la URL para que sea apta para incrustaci√≥n (embed) y ajustamos par√°metros -->
                    <iframe 
                        width="100%" 
                        height="100%" 
                        frameborder="0" 
                        style="border:0" 
                        src="https://www.google.com/maps/embed?pb=!1m18!1m12!1m3!1d3278.4310574768297!2d-58.6856103!3d-34.6622291!2m3!1f0!2f0!3f0!3m2!1i1024!2i768!4f13.1!3m3!1m2!1s0x95bcbf7d64b5722d:0x26f952505a9332c0!2sAv.%20Rivadavia%2022800%2C%20B1714%20Ituzaing%C3%B3%2C%20Provincia%20de%20Buenos%20Aires!5e0!3m2!1sen!2sar!4v1678822000000!5m2!1sen!2sar" 
                        allowfullscreen="" 
                        loading="lazy" 
                        referrerpolicy="no-referrer-when-downgrade">
                    </iframe>
                </div>
            </div>
        </section>

        <!-- Derechos de Autor (Abajo del todo) -->
        <div class="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-4 border-t border-gray-800 text-center">
            <p class="text-sm text-gray-500">&copy; 2025 SAMAA PADEL CLUB. Todos los derechos reservados.</p>
        </div>
    </main>

    <script type="module">
        // Importaciones de Firebase SDK (Solo para intentar la persistencia compartida)
        // Se carga con 'try-catch' para que el fallo no bloquee la interfaz
        import { initializeApp } from "https://www.gstatic.com/firebasejs/11.6.1/firebase-app.js";
        import { getAuth, signInAnonymously, signInWithCustomToken } from "https://www.gstatic.com/firebasejs/11.6.1/firebase-auth.js";
        import { getFirestore, doc, getDoc, setDoc, arrayUnion } from "https://www.gstatic.com/firebasejs/11.6.1/firebase-firestore.js";
        import { setLogLevel } from "https://www.gstatic.com/firebasejs/11.6.1/firebase-firestore.js";
        
        // --- VARIABLES DE ENTORNO ---
        const appId = typeof __app_id !== 'undefined' ? __app_id : 'default-app-id';
        const firebaseConfig = JSON.parse(typeof __firebase_config !== 'undefined' ? __firebase_config : '{}');
        const initialAuthToken = typeof __initial_auth_token !== 'undefined' ? __initial_auth_token : null;
        
        let app, db, auth;
        let isAuthReady = false; // Estado para saber si la conexi√≥n a Firebase es exitosa
        
        // --- CONSTANTES DE LA APLICACI√ìN ---
        let selectedTimeSlots = []; 
        const PRECIO_POR_HORA = 10000; 
        const CLUB_WHATSAPP_NUMBER = "5491140798131"; 

        // Datos simulados de disponibilidad (Bloques ocupados por defecto)
        const mockAvailability = {
            'cancha1-2025-12-02': ['17:00', '17:30', '21:00'], 
            'cancha2-2025-12-02': ['10:00', '10:30', '19:00', '22:00'],
            'cancha3-2025-12-02': ['10:30', '17:00', '20:00', '22:30'],
            'cancha1-2025-12-03': ['10:00', '10:30', '11:00', '11:30', '12:00'], 
            'cancha2-2025-12-03': ['18:00', '18:30', '19:00', '19:30', '20:00'],
            'cancha3-2025-12-03': ['21:00', '21:30', '22:00', '22:30'],
        };

        // --- REFERENCIAS DOM ---
        const form = document.getElementById('reservationForm');
        const messageBox = document.getElementById('messageBox');
        const submitButton = document.getElementById('submitButton');
        const horariosGrid = document.getElementById('horariosGrid');
        const canchaSelect = document.getElementById('cancha');
        const fechaInput = document.getElementById('fecha');
        const daysSlider = document.getElementById('days-slider');
        const canchaTabs = document.querySelectorAll('.cancha-tab');
        const horarioMessage = document.getElementById('horario-message'); // Mensaje en la grilla

        // --- FIREBASE FIRESTORE CONFIG ---
        const getSlotsDocRef = (cancha, fecha) => {
            if (!db) return null;
            const docId = `${cancha}-${fecha}`;
            return doc(db, `artifacts/${appId}/public/data/samaa_padel_slots`, docId);
        };

        // --- FUNCI√ìN DE AUTENTICACI√ìN (EN SEGUNDO PLANO) ---
        async function authenticateAndInitializeDB() {
            try {
                // Validaci√≥n estricta de configuraci√≥n
                if (!firebaseConfig || !firebaseConfig.apiKey || Object.keys(firebaseConfig).length === 0) {
                    throw new Error("Missing/Invalid Firebase configuration. Running in local mode.");
                }
                
                app = initializeApp(firebaseConfig);
                db = getFirestore(app);
                auth = getAuth(app);
                
                // Intento de autenticaci√≥n (usa token si existe, sino an√≥nimo)
                if (initialAuthToken) {
                    await signInWithCustomToken(auth, initialAuthToken);
                } else {
                    await signInAnonymously(auth);
                }
                
                isAuthReady = true;
                console.log("Firebase conectado y autenticado. Persistencia compartida ACTIVA.");
                
                // Si la conexi√≥n es exitosa, disparamos una recarga de horarios para cargar la data compartida.
                renderHorarios();

            } catch (error) {
                // Si la conexi√≥n falla (incluyendo el error de projectId), la app sigue funcionando en modo local.
                console.error("Firebase fall√≥. Persistencia compartida INACTIVA. Usando localStorage.", error);
                isAuthReady = false; 
                if (horarioMessage) {
                    horarioMessage.innerHTML = "‚ö†Ô∏è **Modo Local:** No se pudo conectar a la base de datos compartida. Las reservas no ser√°n visibles para otros usuarios.";
                    horarioMessage.classList.remove('text-gray-500');
                    horarioMessage.classList.add('text-yellow-400');
                }
            }
        }
        
        // --- Funciones auxiliares ---

        function generateAll30MinSlots() {
            const slots = [];
            const startHour = 10;
            const endHour = 24; 
            
            for (let h = startHour; h < endHour; h++) {
                slots.push(`${String(h).padStart(2, '0')}:00`);
                if (h < 23) {
                    slots.push(`${String(h).padStart(2, '0')}:30`);
                }
            }
            slots.push('23:30');
            return slots; 
        }

        const allHours30Min = generateAll30MinSlots();

        function updatePaymentSummary() {
            const numBlocks = selectedTimeSlots.length;
            const costoTotal = (numBlocks / 2) * PRECIO_POR_HORA; 
            
            document.getElementById('numBloques').textContent = numBlocks;
            document.getElementById('costoTotal').textContent = `$${costoTotal.toLocaleString('es-AR')} ARS`;

            submitButton.disabled = numBlocks === 0;
        }

        function handleSlotClick(e) {
            const slotElement = e.currentTarget;
            const time = slotElement.dataset.time;
            
            if (slotElement.hasAttribute('disabled')) return;
            
            const index = selectedTimeSlots.indexOf(time);
            
            if (index > -1) {
                selectedTimeSlots.splice(index, 1);
                slotElement.classList.remove('selected');
            } else {
                selectedTimeSlots.push(time);
                slotElement.classList.add('selected');
                selectedTimeSlots.sort();
            }

            updatePaymentSummary();
        }

        function showMessageWithWhatsApp(userName, waLink) {
            const successText = `¬°Reserva exitosa, ${userName}! Por favor, env√≠a el comprobante de la se√±a para completar la reserva.`;
            
            messageBox.classList.remove('hidden', 'bg-red-900', 'border-red-600', 'bg-primary-dark', 'border-gray-700');
            messageBox.classList.add('bg-green-900', 'border-green-600', 'border');

            messageBox.innerHTML = `
                <p id="messageText" class="font-semibold mb-3">${successText}</p>
                <a href="${waLink}" target="_blank" class="inline-flex items-center space-x-2 bg-[#25D366] hover:bg-[#1DA851] text-white font-bold py-2 px-4 rounded-lg transition duration-200 shadow-lg transform hover:scale-[1.02]">
                    <svg class="w-5 h-5" fill="currentColor" viewBox="0 0 24 24"><path d="M12.04 2c-5.46 0-9.9 4.44-9.9 9.9 0 1.77.47 3.45 1.35 4.96L2 22l5.24-1.42c1.46.79 3.1 1.25 4.8 1.25 5.46 0 9.9-4.44 9.9-9.9C21.94 6.44 17.5 2 12.04 2zM17.15 15.65c-.19.49-1.12.92-1.63 1c-.51.08-.94.04-1.32-.12-.38-.17-1.32-.48-2.5-1.55-1.78-1.57-2.96-3.52-3.3-4.1-.34-.58-.02-.91.24-1.17.26-.26.58-.62.77-.92.19-.3.26-.54.38-.85.12-.31.06-.58-.02-.85-.08-.26-.78-1.87-1.07-2.54-.29-.68-.58-.59-.79-.59-.21 0-.45-.03-.66-.03-.21 0-.54.08-.82.4-.29.31-1.11 1.08-1.11 2.65 0 1.57 1.13 3.06 1.29 3.29.16.23 2.2 3.5 5.31 4.79 3.11 1.29 3.73 1.05 4.39.99.66-.06 1.12-.41 1.32-.64.19-.23.36-.45.52-.61.16-.16.35-.35.54-.23.19.12.83.39 1.18.72.35.33.62.63.74.83.12.2.19.41.06.64z"/></svg>
                    <span>Enviar Comprobante por WhatsApp</span>
                </a>
            `;
            
            setTimeout(() => {
                messageBox.classList.add('hidden');
                messageBox.innerHTML = ''; 
            }, 8000);
        }

        function showSimpleMessage(text, isSuccess) {
            messageBox.classList.remove('hidden', 'bg-red-900', 'bg-green-900', 'border-red-600', 'border-green-600', 'border');
            
            messageBox.classList.add(isSuccess ? 'bg-green-900' : 'bg-red-900', 'border', isSuccess ? 'border-green-600' : 'border-red-600');
            
            messageBox.innerHTML = `<p class="font-semibold">${text}</p>`;

            setTimeout(() => {
                messageBox.classList.add('hidden');
                messageBox.innerHTML = ''; 
            }, 5000);
        }

        // --- FUNCI√ìN PRINCIPAL DE RENDERIZADO (H√çBRIDO) ---
        async function renderHorarios() {
            
            const cancha = canchaSelect.value;
            const fecha = fechaInput.value;
            
            selectedTimeSlots = [];
            updatePaymentSummary();
            
            // Mostrar un mensaje inicial o spinner solo si la UI no est√° cargada
            if (!horariosGrid.hasChildNodes() || horariosGrid.textContent.includes("Selecciona una cancha y una fecha")) {
                 horariosGrid.innerHTML = `<div class="col-span-full text-center p-4"><p id="horario-message" class="text-gray-500 mt-2">Cargando disponibilidad...</p></div>`;
            }

            if (!cancha || !fecha) {
                horariosGrid.innerHTML = `<p class="col-span-full text-center text-gray-500">Selecciona una cancha y una fecha.</p>`;
                return;
            }
            
            const key = `${cancha}-${fecha}`;
            let occupiedTimes = mockAvailability[key] || []; // 1. MOCK DATA

            if (isAuthReady) {
                // 2. FIRESTORE (Si est√° listo)
                try {
                    const docRef = getSlotsDocRef(cancha, fecha);
                    const docSnap = await getDoc(docRef);

                    if (docSnap.exists() && docSnap.data().occupiedSlots) {
                        occupiedTimes = [...new Set([...occupiedTimes, ...docSnap.data().occupiedSlots])];
                    }
                } catch (error) {
                    console.error("Error al obtener datos de Firestore. Usando modo local completo.", error);
                    // No cambiamos isAuthReady aqu√≠, solo reportamos el error de lectura.
                    // Fallback a LocalStorage para lectura.
                    const localOccupied = JSON.parse(localStorage.getItem(`local_reserved_${key}`) || '[]');
                    occupiedTimes = [...new Set([...occupiedTimes, ...localOccupied])];
                }
            } else {
                // 3. LOCALSTORAGE (Si Firebase FALLA O NO EST√Å LISTO)
                const localOccupied = JSON.parse(localStorage.getItem(`local_reserved_${key}`) || '[]');
                occupiedTimes = [...new Set([...occupiedTimes, ...localOccupied])];
            }
            
            // --- GENERACI√ìN DE HTML ---
            let html = '';
            
            allHours30Min.forEach(time => {
                const isAvailable = !occupiedTimes.includes(time);
                
                let containerClasses;
                let disabledAttr = isAvailable ? '' : 'disabled';
                
                let statusText = isAvailable ? 'Libre' : 'Ocupado';
                let timeColor;
                let statusColor;

                if (isAvailable) {
                    containerClasses = 'bg-secondary-dark border border-gray-700 cursor-pointer hover:bg-gray-700';
                    timeColor = 'text-white';
                    statusColor = 'text-gray-400';
                } else {
                    containerClasses = 'bg-primary-dark border border-gray-800 cursor-not-allowed opacity-70';
                    timeColor = 'text-gray-500';
                    statusColor = 'text-gray-600';
                }
                
                html += `
                    <div class="time-slot block rounded-lg transition duration-150 ease-in-out ${containerClasses} ${disabledAttr}" data-time="${time}">
                        <span class="slot-content">
                            <span class="text-xl font-bold ${timeColor} block">${time}</span>
                            <span class="text-xs ${statusColor} block">${statusText}</span>
                        </span>
                    </div>
                `;
            });

            horariosGrid.innerHTML = html;
            
            const availableSlots = document.querySelectorAll('.time-slot:not([disabled])');
            
            availableSlots.forEach(slot => {
                slot.addEventListener('click', handleSlotClick);
            });
            
            if (availableSlots.length === 0 && allHours30Min.length > 0) {
                 horariosGrid.innerHTML = `<p class="col-span-full text-center text-red-400 font-semibold p-4 bg-primary-dark rounded-lg">
                     ¬°ATENCI√ìN! No quedan bloques disponibles en esta cancha para la fecha seleccionada.
                 </p>`;
            } else {
                // Si hay slots, limpiamos el mensaje de "Cargando" si no hay una advertencia activa.
                if (horarioMessage && !horarioMessage.textContent.includes("‚ö†Ô∏è")) {
                     horarioMessage.textContent = "";
                }
            }
        }
        
        // --- Funciones de D√≠as y Canchas (sin cambios) ---

        function getDayName(date, index) {
            const days = ['Dom', 'Lun', 'Mar', 'Mi√©', 'Jue', 'Vie', 'S√°b'];
            if (index === 0) return 'HOY';
            return days[date.getDay()];
        }
        
        function renderDaysSlider(selectedDateString) {
            daysSlider.innerHTML = ''; 
            const today = new Date();
            let selectedDateFound = false;

            for (let i = 0; i < 15; i++) { 
                const day = new Date(today);
                day.setDate(today.getDate() + i);
                
                const dayName = getDayName(day, i);
                const dayNum = day.getDate();
                const dayDateString = day.toISOString().split('T')[0];
                
                const isSelected = dayDateString === selectedDateString;
                
                let dayClass = 'text-white bg-primary-dark hover:bg-gray-700';
                
                if (i === 0) {
                    dayClass = 'text-primary-dark bg-accent font-bold shadow-lg';
                } else if (isSelected) {
                    dayClass = 'text-white bg-gray-600 border border-accent'; 
                }

                const dayElement = document.createElement('div');
                dayElement.className = `inline-block p-2 text-center rounded-xl cursor-pointer transition duration-150 ease-in-out ${dayClass}`;
                dayElement.dataset.date = dayDateString;
                dayElement.dataset.index = i;

                dayElement.innerHTML = `
                    <span class="text-sm block leading-none">${dayName}</span>
                    <span class="text-2xl font-extrabold block leading-none">${dayNum}</span>
                `;
                
                dayElement.addEventListener('click', () => selectDay(dayDateString));
                daysSlider.appendChild(dayElement);

                if (isSelected) selectedDateFound = true;
            }

            if (!selectedDateFound) {
                 selectDay(today.toISOString().split('T')[0]);
            }
        }

        function selectDay(dateString) {
            fechaInput.value = dateString;
            
            document.querySelectorAll('#days-slider > div').forEach(div => {
                const dayIndex = parseInt(div.dataset.index);
                div.classList.remove('bg-gray-600', 'border', 'border-accent');
                if (dayIndex === 0) {
                     div.classList.add('text-primary-dark', 'bg-accent');
                     div.classList.remove('text-white', 'bg-primary-dark');
                } else {
                     div.classList.add('bg-primary-dark', 'text-white');
                     div.classList.remove('text-primary-dark', 'bg-accent');
                }
            });

            const selectedDiv = document.querySelector(`[data-date="${dateString}"]`);
            if (selectedDiv && selectedDiv.dataset.index !== '0') {
                 selectedDiv.classList.remove('bg-primary-dark');
                 selectedDiv.classList.add('bg-gray-600', 'border', 'border-accent');
            }

            renderHorarios();
        }

        function selectCancha(selectedCancha) {
            canchaTabs.forEach(tab => {
                const isSelected = tab.dataset.cancha === selectedCancha;
                
                if (isSelected) {
                    tab.classList.add('bg-accent', 'text-primary-dark');
                    tab.classList.remove('text-gray-400', 'hover:bg-gray-700');
                } else {
                    tab.classList.remove('bg-accent', 'text-primary-dark');
                    tab.classList.add('text-gray-400', 'hover:bg-gray-700');
                }

                if (isSelected) {
                    canchaSelect.value = selectedCancha;
                }
            });
            
            renderHorarios();
        }

        canchaTabs.forEach(tab => {
            tab.addEventListener('click', (e) => selectCancha(e.currentTarget.dataset.cancha));
        });

        // --- MANEJO DE ENV√çO DE FORMULARIO (H√çBRIDO) ---
        form.addEventListener('submit', async function(e) {
            e.preventDefault();

            if (selectedTimeSlots.length === 0) {
                showSimpleMessage('Error: Debes seleccionar al menos un bloque de 30 minutos.', false);
                return;
            }

            submitButton.disabled = true;
            submitButton.textContent = 'Procesando...';
            submitButton.classList.remove('bg-accent', 'hover:bg-accent-hover');
            submitButton.classList.add('bg-gray-600', 'cursor-not-allowed');

            const isPaymentAccepted = document.getElementById('aceptarPago').checked;

            const formData = {
                fecha: fechaInput.value,
                cancha: canchaSelect.value,
                horarios: selectedTimeSlots, 
                nombre: document.getElementById('nombre').value,
                whatsapp: document.getElementById('whatsapp').value,
                pagoAceptado: isPaymentAccepted 
            };
            
            const totalCosto = (selectedTimeSlots.length / 2) * PRECIO_POR_HORA;


            if (!formData.fecha || !formData.cancha || !formData.nombre || !formData.whatsapp) {
                showSimpleMessage('Error: Por favor, completa todos los campos requeridos.', false);
            } else if (!formData.pagoAceptado) {
                showSimpleMessage('Error: Debes aceptar la se√±a de ARS 10.000 para confirmar la reserva.', false);
            } else {
                
                let success = false;
                let usedSharedDB = false;

                if (isAuthReady) {
                    // INTENTAR GUARDAR EN FIRESTORE
                    try {
                        const docRef = getSlotsDocRef(formData.cancha, formData.fecha);
                        await setDoc(docRef, { 
                            occupiedSlots: arrayUnion(...formData.horarios),
                            lastUpdated: new Date()
                        }, { merge: true });
                        success = true;
                        usedSharedDB = true;
                        console.log("Reserva guardada exitosamente en Firestore.");
                    } catch (error) {
                        console.error("Fallo al guardar en Firestore. Usando localStorage de respaldo.", error);
                        // Fallback a LocalStorage si falla el guardado
                        const key = `${formData.cancha}-${formData.fecha}`;
                        const currentOccupied = JSON.parse(localStorage.getItem(`local_reserved_${key}`) || '[]');
                        const newOccupied = [...new Set([...currentOccupied, ...formData.horarios])];
                        localStorage.setItem(`local_reserved_${key}`, JSON.stringify(newOccupied));
                        success = true; 
                    }
                } 
                
                if (!usedSharedDB) {
                    // GUARDAR SOLO EN LOCALSTORAGE (Modo sin conexi√≥n)
                    const key = `${formData.cancha}-${formData.fecha}`;
                    const currentOccupied = JSON.parse(localStorage.getItem(`local_reserved_${key}`) || '[]');
                    const newOccupied = [...new Set([...currentOccupied, ...formData.horarios])];
                    localStorage.setItem(`local_reserved_${key}`, JSON.stringify(newOccupied));
                    success = true;
                }
                
                if (success) {
                    // PREPARA MENSAJE WHATSAPP (CORRECTO Y CODIFICADO)
                    const sortedSlots = formData.horarios.sort();
                    const slotsList = sortedSlots.join(', ');
                    
                    let waMessageText = `¬°Hola SAMAA PADEL! Acabo de realizar una reserva online.

Detalles:
üë§ Cliente: ${formData.nombre}
üìÖ Fecha: ${formData.fecha}
üéæ Cancha: ${formData.cancha}
‚è∞ Horarios: ${slotsList} hs
üíµ Costo total simulado: $${totalCosto.toLocaleString('es-AR')} ARS
üìû Contacto: ${formData.whatsapp}

Adjunto el comprobante de la se√±a de ARS 10.000.`;

                    const encodedMessage = encodeURIComponent(waMessageText);
                    const waLink = `https://wa.me/${CLUB_WHATSAPP_NUMBER}?text=${encodedMessage}`;

                    // MUESTRA MENSAJE DE √âXITO CON BOT√ìN WHATSAPP
                    showMessageWithWhatsApp(formData.nombre, waLink);
                    form.reset(); 
                    
                    // Recarga la grilla
                    renderHorarios();
                } else {
                    showSimpleMessage('Error cr√≠tico al procesar la reserva.', false);
                }
            }

            // Habilitar bot√≥n de nuevo
            submitButton.disabled = false;
            submitButton.textContent = 'PAGAR Y CONFIRMAR RESERVA';
            submitButton.classList.remove('bg-gray-600', 'cursor-not-allowed');
            submitButton.classList.add('bg-accent', 'hover:bg-accent-hover');
            updatePaymentSummary(); // Reiniciar a 0 bloques
        });
        
        // --- INICIO DE LA APLICACI√ìN ---
        window.onload = function() {
            // 1. Inicializar la UI inmediatamente
            const todayString = (new Date()).toISOString().split('T')[0];
            fechaInput.value = todayString;
            renderDaysSlider(todayString);
            selectCancha('cancha1');

            // 2. Intentar conectar la DB en segundo plano
            try {
                setLogLevel('Debug');
                authenticateAndInitializeDB(); 
            } catch (error) {
                 console.error("Error al iniciar el proceso de DB:", error);
            }
        };
    </script>
</body>
</html>
